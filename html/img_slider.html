<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width" />
    <title>img slider</title>
    <meta name="Keywords" content="">
    <meta name="Description" content="">
    <link rel="stylesheet" href="../css/base.css" />
    <script src="../js/jquery-3.2.1.min.js"></script>
    <!--[if lt ie 9]>
    <script src="../js/html5.js"></script>
    <script src="../js/respond.js"></script>
    <![endif]-->
    <style>
        .slider_wrap {margin:0 auto 0; width:760px; height:924px; position:relative;}
        .slider_btn {margin-top:-25px; width:50px; height:50px; position:absolute; top:50%; background-color:rgba(47, 47, 47, 0.3); z-index:1;}
        [data-btn="prev"] {left:-50px;}
        [data-btn="next"] {right:-50px;}
        .slider_cover {width:100%; height:100%; position:relative; overflow:hidden;}
        [data-gallery="wrap"] {font-size:0; letter-spacing:0; word-spacing:0; position:absolute; white-space:nowrap;}
        [data-slider="list"] {display:inline-block; position:relative;}
        span {font-size:12px; position:absolute; left:50px; top:50px;}
        [data-paging="wrap"] {width:100%; text-align:center; position:absolute; left:0; bottom:30px; z-index:1;}
        [data-paging="list"] {margin:0 5px 0 5px; width:30px; height:30px; display:inline-block; line-height:30px; background:#ddd;}
        [data-paging="list"]>button {width:100%; height:100%; display:block;}
        [data-paging="list"].on {background:#000;}
        [data-paging="list"].on>button {color:#fff;}
    </style>
</head>
<body>
    <div id="slider1" class="slider_wrap">
        <button type="button" class="slider_btn" data-btn="prev">prev1</button>
        <button type="button" class="slider_btn" data-btn="next">next1</button>
        <div class="slider_cover">
            <ul data-gallery="wrap">
                <li data-slider="list"><span>1</span><img src="../images/slider/02.jpg" alt="" /></li>
                <li data-slider="list"><span>2</span><img src="../images/slider/03.jpg" alt="" /></li>
            </ul>
        </div>
    </div>
    <div id="slider2" class="slider_wrap">
        <button type="button" class="slider_btn" data-btn="prev">prev2</button>
        <button type="button" class="slider_btn" data-btn="next">next2</button>
        <div class="slider_cover">
            <ul data-gallery="wrap">
                <li data-slider="list"><span>1</span><img src="../images/slider/02.jpg" alt="" /></li>
                <li data-slider="list"><span>2</span><img src="../images/slider/04.jpg" alt="" /></li>
                <li data-slider="list"><span>3</span><img src="../images/slider/05.jpg" alt="" /></li>
                <li data-slider="list"><span>4</span><img src="../images/slider/06.jpg" alt="" /></li>
                <li data-slider="list"><span>5</span><img src="../images/slider/07.jpg" alt="" /></li>
                <li data-slider="list"><span>6</span><img src="../images/slider/01.jpg" alt="" /></li>
                <li data-slider="list"><span>7</span><img src="../images/slider/03.jpg" alt="" /></li>
            </ul>
        </div>
    </div>
    <div id="slider3" class="slider_wrap">
        <button type="button" class="slider_btn" data-btn="prev">prev3</button>
        <button type="button" class="slider_btn" data-btn="next">next3</button>
        <div class="slider_cover">
            <ul data-gallery="wrap">
                <li data-slider="list"><span>1</span><img src="../images/slider/02.jpg" alt="" /></li>
                <li data-slider="list"><span>2</span><img src="../images/slider/04.jpg" alt="" /></li>
                <li data-slider="list"><span>3</span><img src="../images/slider/05.jpg" alt="" /></li>
                <li data-slider="list"><span>4</span><img src="../images/slider/02.jpg" alt="" /></li>
                <li data-slider="list"><span>5</span><img src="../images/slider/03.jpg" alt="" /></li>
            </ul>
        </div>
    </div>
    <script type="text/javascript">
        var sliderModule = (function (window, document, $, undefined) {

            var $btn = $("[data-btn]"),
                $wrap = $("[data-gallery='wrap']"),
                $list = $("[data-slider='list']"),
                _pagingWrap = "data-paging='wrap'",
                _paging = "data-paging='list'";


            var init = function(opts){
                $.each(opts.element, function(i, item) {
                    var obj     = {};
                    obj.element  = item;
                    obj.idx = opts.idx[i];
                    obj.len = $(item).find($list).length;
                    obj.paging = opts.paging[i];
                    obj.setChk = true;

                    var first = $(obj.element).find($list).first($list).clone();
                    var last = $(obj.element).find($list).last($list).clone();
                    $(obj.element).find($wrap).append(first);
                    $(obj.element).find($wrap).prepend(last);

                    sliderAnimation(obj);
                    controls(obj);
                });
            };

            function controls(obj){
                $(obj.element).find($btn).off().on("click", function(e){
                    var target = $(this).data("btn");
                    prevnext(obj, target);
                });

                $(obj.element).find("["+_paging+"]").on("click", function(e){
                    var thisNum = $(this).index();
                    obj.idx = thisNum+1;
                    sliderAnimation(obj);
                });
            };

            function prevnext(obj, target){
                if($(obj.element).find($wrap).is(":not(:animated)")){
                    if(target=="next"){
                        obj.idx = obj.idx+1;
                        sliderAnimation(obj);
                    }else if(target=="prev"){
                        obj.idx = obj.idx-1;
                        sliderAnimation(obj);
                    }
                }
            };

            function sliderAnimation(obj){
                if(obj.setChk==true){
                    obj.idx = (obj.idx>obj.len || obj.idx<=0) ? 1 : obj.idx;
                    $(obj.element).find($wrap).css({left:-$(obj.element).width()*obj.idx});
                    if(obj.paging==true){
                        pagingSet(obj);
                        sliderPaging(obj);
                    }
                    obj.setChk = false;
                }else{
                    $(obj.element).find($wrap).stop().animate({left:-$(obj.element).width()*obj.idx}, function(){
                        var cycle = (0===obj.idx || obj.len+1===obj.idx);
                        if(cycle){
                            obj.idx = (obj.idx === 0)? obj.len : 1;
                            $(obj.element).find($wrap).css({left:-$(obj.element).width()*obj.idx});
                        }
                        if(obj.paging==true){
                            sliderPaging(obj);
                        }
                    });
                }
            }

            function sliderPaging(obj){
                $(obj.element).find($("["+_paging+"]")).removeClass("on");
                $(obj.element).find($("["+_paging+"]")).eq(obj.idx-1).addClass("on");
            }

            function pagingSet(obj){
                $(obj.element).find($wrap).after("<ul "+_pagingWrap+">");
                for ( var i=1 ; i<obj.len+1 ; i++ ){
                    $(obj.element).find($("["+_pagingWrap+"]")).append("<li "+_paging+"><button type='button'>"+i+"");
                }
            }

            return{
                option:init
            };
        })(window, document, $);

        new sliderModule.option({
            element:["#slider1", "#slider2", "#slider3"],
            idx:[1, 5, 3],
            paging:[true, false, true]
        });
    </script>
</body>
</html>
