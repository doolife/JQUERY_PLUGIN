<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width" />
<title>퀵메뉴</title>
<meta name="Keywords" content="">
<meta name="Description" content="">
<link rel="stylesheet" href="../css/base.css" />
<script src="../js/jquery-3.2.1.min.js"></script>
<!--[if lt ie 9]>
<script src="../js/html5.js"></script>
<script src="../js/respond.js"></script>
<![endif]-->
<style>
.wrap {position:relative; overflow-x:hidden;}
header {height:700px; position:relative;}
header:before {content:"확인용구분선"; width:100%; height:1px; text-align:center; position:absolute; top:400px; left:0; background:#000;}
/* side_menu */
#quickMenu {width:100px; position:absolute; right:0; top:400px; background:#ddd;}
#quickMenu>.btn_arrow {margin-top:-50px; width:50px; height:100px; display:block; background:#fff; position:absolute; top:50%; left:-50px; border:1px solid #ddd;}
#quickMenu>.btn_arrow:before {content:"<";}
#quickMenu>.btn_arrow.on:before {content:">";}
#quickMenu>.menu_list li {width:100%;}
#quickMenu>.menu_list li a.active {background:brown; color:#fff;}
#quickMenu>.menu_list>li a {width:100%; height:50px; display:block;}
#quickMenu>.menu_list>li>ul a {text-align:center;}
#quickMenu>.btn_top {width:100px; height:100px; display:block; background:#fff; position:absolute; bottom:-100px; left:0;}
section {text-align:center;}
.section1_1 {height:500px; background:#0b8ebf;}
.section1_2 {height:500px; background:#3e6b88;}
.section2 {background:#29f969;}
.section2_1 {height:500px; background:cornflowerblue;}
.section2_2 {height:500px; background:deepskyblue;}
.section2_3 {height:500px; background:lightblue;}
.section2_4 {height:500px; background:blueviolet;}
.section3_1 {height:1000px; background:deeppink;}
.section4 {height:2500px; background:#0b8ebf;}
</style>
</head>
<body>
    <div class="wrap">
        <header>header</header>

        <aside id="quickMenu">
            <button type="button" class="btn_arrow" data-btn="arrow"></button>
            <ul class="menu_list" data-quick="wrap">
                <li data-list="list">
                    <a href="#section1">1</a>
                    <ul>
                        <li data-list="list"><a href="#section1_1">1_1</a></li>
                        <li data-list="list"><a href="#section1_2">1_2</a></li>
                    </ul>
                </li>
                <li data-list="link"><a href="http://www.google.co.kr" target="_blank">google</a></li>
                <li data-list="list">
                    <a href="#section2">2</a>
                    <ul>
                        <li data-list="list"><a href="#section2_1">2_1</a></li>
                        <li data-list="list"><a href="#section2_2">2_2</a></li>
                        <li data-list="list"><a href="#section2_3">2_3</a></li>
                        <li data-list="list"><a href="#section2_4">2_4</a></li>
                    </ul>
                </li>
                <li data-list="list"><a href="#section3" target="_blank">3</a></li>
            </ul>
            <button type="button" class="btn_top" data-btn="top">TOP</button>
        </aside>

        <section data-id="section1" data-contents="con" class="section1">
            <div data-id="section1_1" data-contents="scon" class="section1_1">1_1</div>
            <div data-id="section1_2" data-contents="scon" class="section1_2">1_2</div>
        </section>
        <section data-id="section2" data-contents="con" class="section2">
            <div data-id="section2_1" data-contents="scon" class="section2_1">section2_1</div>
            <div data-id="section2_2" data-contents="scon" class="section2_2">section2_2</div>
            <div data-id="section2_3" data-contents="scon" class="section2_3">section2_3</div>
            <div data-id="section2_4" data-contents="scon" class="section2_4">section2_4</div>
        </section>
        <section data-id="section3" data-contents="con" class="section3">
            <div data-id="section3_1" data-contents="scon" class="section3_1">3_1</div>
        </section>
        <section class="section4">5</section>
    </div>
    <script>
        var QUICKMENU = (function (window, document, $, undefined) {

            var top, fixTop, qspeed, cspeed, tspeed, delay, timeout, $wrap, $gnb, $con, $btnTop, show, _settings = true, setSp = true, gnbNum, snbNum, removeChk = false, linkChk;

            var init = function(opts) {
                $wrap = $(opts.element),
                $gnb = $wrap.find($("[data-quick='wrap']")).children("[data-list]"),
                $snb = $gnb.find("[data-list]"),
                $con = $("[data-contents='con']"), $scon = $("[data-contents='scon']"), $btnArrow = $("[data-btn='arrow']"), $btnTop = $("[data-btn='top']");
                fixTop = opts.fix, qspeed = opts.qspeed, cspeed = opts.cspeed, tspeed = opts.tspeed, delay = opts.delay, show = opts.show, top = $wrap.offset().top;

                controls();
                arrowSlide();
            };

            var controls = function(){
                $gnb.children("a").on("click", function(e){
                    var hash = $(this).attr("href"), reStr = hash.replace(/#/g, "");
                    listSlide(reStr, e);
                });

                $snb.children("a").on("click", function(e){
                    e.preventDefault();
                    var hash = $(this).attr("href"), reStr = hash.replace(/#/g, "");
                    listSlide(reStr, e);
                });

                $(window).on("scroll", function(){
                    clearTimeout(timeout);
                    timeout = setTimeout(function(){
                        scrollAction();
                    }, delay);
                });

                $btnArrow.on("click", function(e){
                    arrowSlide();
                });

                $btnTop.on("click", function(e){
                    e.preventDefault();
                    $("html, body").stop().animate({scrollTop:0}, tspeed);
                });
            };

            function scrollAction(){
                var scltop     = $(window).scrollTop();
                if(scltop >= top-fixTop){
                    if(_settings!=true){
                        $wrap.stop().animate({top:$(window).scrollTop()+fixTop}, qspeed);
                    }else{
                        $wrap.css({top:$(window).scrollTop()+fixTop});
                        _settings = false;
                    }
                }else{
                    $wrap.stop().animate({top:top}, qspeed);
                }
                gnbAnchor(scltop);

                // for( var i=0, len=$list.length ; i<len ; i++ ){
                //     var conTop = $con.eq(i).offset().top;
                //     if(conTop<=scltop){
                //         if($list.eq(i).data("list")=="link"){
                //             $list.removeClass("active");
                //         }else{
                //             $list.removeClass("active");
                //             $list.eq(i).addClass("active");
                //         }
                //     }
                //     if(scltop<firstTop || scltop>lastBottom){
                //         $list.removeClass("active");
                //     }
                // }
            }

            function gnbAnchor(scltop){
                firstTop   = $con.eq(0).offset().top,
                lastBottom = $con.eq($con.length-1).offset().top + $con.eq($con.length-1).height();
                for( var i=0, len=$con.length ; i<len ; i++ ){
                    var conTop = $con.eq(i).offset().top;
                    if(conTop<=scltop){
                        gnbNum = i;
                        for( var j=0, slen=$con.eq(i).children($scon).length ; j<slen ; j++ ){
                            var sconTop = $con.eq(i).children($scon).eq(j).offset().top;
                            if(sconTop<=scltop){
                                snbNum = j;
                            }
                        }
                    }
                    removeChk = (scltop<firstTop || scltop>lastBottom) ? true : false ;
                }
                if(!removeChk){
                    $gnb.children("a").removeClass("active");
                    $gnb.eq(gnbNum).children("a").addClass("active");
                    $gnb.find($snb).children("a").removeClass("active");
                    $gnb.eq(gnbNum).find($snb).eq(snbNum).children("a").addClass("active");
                }else{
                    $gnb.children("a").removeClass("active");
                    $gnb.find($snb).children("a").removeClass("active");
                }
            }

            function arrowSlide(){
                setSp = (setSp==true) ? setSp = "0s" : setSp = "0.4s";
                if(show==true){
                    $wrap.css({transition:"transform "+setSp+"", transform:"translateX(0px)"}).find($btnArrow).addClass("on");
                    show = false;
                }else{
                    $wrap.css({transition:"transform "+setSp+"", transform:"translateX("+$wrap.width()+"px)"}).find($btnArrow).removeClass("on");
                    show = true;
                }
            }

            function listSlide(name, e){
                // var conOffset = $("[data-id='"+name+"']").offset().top;
                // if($list.eq(thisNum).data("list")!="link"){
                //     e.preventDefault();
                //     $("html, body").stop().animate({scrollTop:conOffset}, cspeed);
                // }
            }

            return {
                options:init
            };

        })(window, document, $);

        new QUICKMENU.options({
            element:"#quickMenu",    // 엘리먼트
            fix:100,    // 스크롤시 상단에서 떨어진 값
            qspeed:300,    // 스크롤시 퀵메뉴 따라다니는 스피드
            cspeed:600,    // 퀵메뉴 클릭시 이동하는 스피드
            tspeed:800,    // TOP버튼 클릭시 퀵메뉴 이동하는 스피드
            delay:10,    // 스크롤 정지 체크 시간
            show:true    // true : show / false : show
        });
    </script>
</body>
</html>
