<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width" />
<title>룰렛 TEST</title>
<meta name="Keywords" content="">
<meta name="Description" content="">
<link rel="stylesheet" href="../css/base.css" />
<link rel="stylesheet" href="../css/parallax.css" />
<script src="../js/jquery-3.2.1.min.js"></script>
<!-- <script src="../js/jQueryRotate.js"></script> -->

<!--[if lt ie 9]>
<script src="../js/html5.js"></script>
<script src="../js/respond.js"></script>
<![endif]-->
<style>
.roulette_wrap {margin:100px auto 0; width:480px; height:480px; position:relative;}
.roulette_obj {width:100%; height:100%; position:absolute; left:0; top:0;}
.arrow {margin-left:-35.5px; width:71px; height:77px; position:absolute; left:50%; top:10px;}
.price {margin:20px auto 20px; width:100px; text-align:center;}
.btn_start {margin:0 auto 0; width:100px; height:50px; display:block; position:relative; z-index:1;}
</style>
</head>
<body>
    <div class="roulette_wrap">
        <div class="roulette_obj"><img src="../images/roulette_bg.png" alt="" /></div>
        <div class="arrow"><img src="../images/arrow.png" id="n_id"></div>
    </div>
    <p class="price">number : <span></span></p>
    <input type="button" value="시작" class="btn_start"></input>

    <script src="../js/jQueryRotate.js"></script>
    <!-- <script src="../js/jquery.fortune.js"></script>
    <script>
        (function() {
            var lastTime = 0;
            var vendors = ['ms', 'moz', 'webkit', 'o'];
            for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
                window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
                window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame']
                || window[vendors[x]+'CancelRequestAnimationFrame'];
            }

            if (!window.requestAnimationFrame)
            window.requestAnimationFrame = function(callback, element) {
                var currTime = new Date().getTime();
                var timeToCall = Math.max(0, 16 - (currTime - lastTime));
                var id = window.setTimeout(function() { callback(currTime + timeToCall); },
                timeToCall);
                lastTime = currTime + timeToCall;
                return id;
            };

            if (!window.cancelAnimationFrame)
                window.cancelAnimationFrame = function(id) {
                clearTimeout(id);
            };
        }());

        var doneChk = true;
        var prices = [
            {
            name: "0"
            },
            {
              name: "1"
            },
            {
              name: "2"
            },
            {
              name: "3"
            }
        ];


        var $r = $(".roulette_obj").fortune(prices);

        var clickHandler = function() {
            doneChk = false;
            console.log(doneChk)
            $r.spin().done(function(price) {
                doneChk = true;
                $(".price").children("span").text(price.name);
            });
        };

        $(document).on("click", ".btn_start", function(){
            if(doneChk==true){
                clickHandler();
            }
        });
    </script> -->
    <script>
        var pArr = ["0","1","2","3"];

        $(".btn_start").click(function(){
            rotateAnimation();
        });

        function rotateAnimation(){
            $(".roulette_obj").rotate({
                angle:0,
                animateTo:(360 * 5) + radomNum(0, 360),
                center: ["50%", "50%"],
                easing: $.easing.easeInOutElastic,
                callback: function(){
                    var aNum = $(this).getRotateAngle();
                    rotateAngleNum(aNum);
                },
                duration:6000
            });
        }

        function rotateAngleNum(angleNum){
            var num = angleNum;
            var realAngle = num%360;
            console.log(num+"|"+realAngle)
            var piece = Math.floor(realAngle/36);
            // console.log(piece)
            // if(piece<1){
            //     console.log(pArr[0]+" : 1")
            // }else if(piece>=4){
            //     console.log(pArr[pArr.length-1]+" : 4")
            // }else{
            //     console.log(pArr[piece])
            // }
        }

        function radomNum(min, max){
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
    </script>
</body>
</html>
